FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGJsYW5rLXZtLWFwYgpkZXNjcmlwdGlvbjogQVBCIGZvciBtYW5h\
Z2luZyBWaXJ0dWFsIE1hY2hpbmUgOQpiaW5kYWJsZTogRmFsc2UKYXN5bmM6IG9wdGlvbmFsCm1l\
dGFkYXRhOgogIGRpc3BsYXlOYW1lOiBCbGFuayBWTSAoQVBCKSA5CiAgaW1hZ2VVcmw6IGh0dHBz\
Oi8vY2RuLnBicmQuY28vaW1hZ2VzL0g1R3V0ZDcucG5nCnBsYW5zOgogIC0gbmFtZTogZGVmYXVs\
dAogICAgZGVzY3JpcHRpb246IFZpcnR1YWwgbWFjaGluZSBjcmVhdGVkIGZyb20gY3VzdG9tIFlB\
TUwKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogQ3VzdG9t\
IFlBTUwKICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBWaXJ0dWFsIG1hY2hpbmUgY3JlYXRlZCBmcm9t\
IGN1c3RvbSBZQU1MCiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IGFkbWluX3VzZXIKICAg\
ICAgICB0aXRsZTogT3BlbnNoaWZ0IEFkbWluIFVzZXIKICAgICAgICB0eXBlOiBzdHJpbmcKICAg\
ICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IGFkbWluX3Bhc3N3b3JkCiAgICAgICAg\
dGl0bGU6IE9wZW5zaGlmdCBBZG1pbiBQYXNzd29yZAogICAgICAgIHR5cGU6IHN0cmluZwogICAg\
ICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogY3VzdG9tX3lhbWwKICAgICAgICB0aXRs\
ZTogQ3VzdG9tIGNvbmZpZ3VyYXRpb24gKFlBTUwpCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAg\
ICAgZGlzcGxheV90eXBlOiB0ZXh0YXJlYQogICAgICAgIHJlcXVpcmVkOiB0cnVlCgogIC0gbmFt\
ZTogbGludXgKICAgIGRlc2NyaXB0aW9uOiBMaW51eCBWaXJ0dWFsIE1hY2hpbmUgRGVwbG95bWVu\
dAogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBMaW51eCBW\
aXJ0dWFsIE1hY2hpbmUKICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBWaXJ0dWFsIG1hY2hpbmUgd2l0\
aCBwcmUtaW5zdGFsbGVkIExpbnV4CiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IGFkbWlu\
X3VzZXIKICAgICAgICB0aXRsZTogT3BlbnNoaWZ0IEFkbWluIFVzZXIKICAgICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IGFkbWluX3Bhc3N3b3Jk\
CiAgICAgICAgdGl0bGU6IE9wZW5zaGlmdCBBZG1pbiBQYXNzd29yZAogICAgICAgIHR5cGU6IHN0\
cmluZwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogdm1uYW1lCiAgICAgICAg\
dGl0bGU6IE5hbWUKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkaXNwbGF5X3R5cGU6IHRl\
eHQKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IG15dm0KICAgICAgLSBu\
YW1lOiB2bW1lbW9yeQogICAgICAgIHRpdGxlOiBNZW1vcnkgKGluIE1pQikKICAgICAgICB0eXBl\
OiBudW1iZXIKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IDY0Cg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
